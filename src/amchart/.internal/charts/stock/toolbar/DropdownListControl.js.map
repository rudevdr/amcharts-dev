{"version":3,"file":"DropdownListControl.js","sourceRoot":"","sources":["../../../../../../../src/.internal/charts/stock/toolbar/DropdownListControl.ts"],"names":[],"mappings":"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","sourcesContent":["import { StockControl, IStockControlSettings, IStockControlPrivate, IStockControlEvents } from \"./StockControl\";\r\nimport { DropdownList, IDropdownListItem } from \"./DropdownList\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\nimport * as $type from \"../../../core/util/Type\";\r\n\r\nexport interface IDropdownListControlSettings extends IStockControlSettings {\r\n\tcurrentItem?: string | IDropdownListItem;\r\n\tfixedLabel?: boolean;\r\n\titems?: Array<string | IDropdownListItem>;\r\n\tscrollable?: boolean;\r\n\tmaxSearchItems?: number,\r\n\tsearchable?: boolean;\r\n\tsearchCallback?: (query: string) => IDropdownListItem[];\r\n}\r\n\r\nexport interface IDropdownListControlPrivate extends IStockControlPrivate {\r\n\tdropdown?: DropdownList;\r\n}\r\n\r\nexport interface IDropdownListControlEvents extends IStockControlEvents {\r\n\tselected: {\r\n\t\titem: string | IDropdownListItem;\r\n\t};\r\n}\r\n\r\n/**\r\n * A generic control which creates a searchable list of items in a dropdown.\r\n *\r\n * Can be used in a [[StockToolbar]].\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/toolbar/dropdown-list-control/} for more info\r\n */\r\nexport class DropdownListControl extends StockControl {\r\n\tpublic static className: string = \"DropdownListControl\";\r\n\tpublic static classNames: Array<string> = StockControl.classNames.concat([DropdownListControl.className]);\r\n\r\n\tdeclare public _settings: IDropdownListControlSettings;\r\n\tdeclare public _privateSettings: IDropdownListControlPrivate;\r\n\tdeclare public _events: IDropdownListControlEvents;\r\n\r\n\tprotected _afterNew() {\r\n\t\t// @todo still needed?\r\n\t\tsuper._afterNew();\r\n\r\n\t\tconst button = this.getPrivate(\"button\")!;\r\n\t\tbutton.className = button.className + \" am5stock-control-dropdown\";\r\n\t}\r\n\r\n\tprotected _initElements(): void {\r\n\t\tsuper._initElements();\r\n\r\n\t\t// Disable icon\r\n\t\t//this.getPrivate(\"icon\")!.style.display = \"none\";\r\n\r\n\t\t// Create list\r\n\t\tconst dropdownSettings: any = {\r\n\t\t\tcontrol: this,\r\n\t\t\tparent: this.getPrivate(\"button\"),\r\n\t\t\tsearchable: this.get(\"searchable\", false),\r\n\t\t\tscrollable: this.get(\"scrollable\", false),\r\n\t\t\titems: []\r\n\t\t}\r\n\r\n\t\tconst maxSearchItems = this.get(\"maxSearchItems\");\r\n\t\tif (maxSearchItems) {\r\n\t\t\tdropdownSettings.maxSearchItems = maxSearchItems;\r\n\t\t}\r\n\r\n\t\tconst searchCallback = this.get(\"searchCallback\");\r\n\t\tif (searchCallback) {\r\n\t\t\tdropdownSettings.searchCallback = searchCallback;\r\n\t\t}\r\n\r\n\t\tconst items = this.get(\"items\");\r\n\t\tlet currentItem = this.get(\"currentItem\");\r\n\t\tif (items) {\r\n\t\t\t$array.each(items, (item) => {\r\n\t\t\t\tconst itemObject = $type.isString(item) ? {\r\n\t\t\t\t\tid: item,\r\n\t\t\t\t\tlabel: item\r\n\t\t\t\t} : item;\r\n\t\t\t\tdropdownSettings.items.push(itemObject);\r\n\r\n\t\t\t\tif ($type.isString(currentItem) && currentItem == itemObject.id) {\r\n\t\t\t\t\tcurrentItem = itemObject;\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tconst dropdown = DropdownList.new(this._root, dropdownSettings);\r\n\t\tthis.setPrivate(\"dropdown\", dropdown);\r\n\r\n\t\tif (currentItem) {\r\n\t\t\tthis.setItem(currentItem);\r\n\t\t}\r\n\r\n\t\tdropdown.events.on(\"closed\", (_ev) => {\r\n\t\t\tthis.set(\"active\", false);\r\n\t\t});\r\n\r\n\t\tdropdown.events.on(\"invoked\", (ev) => {\r\n\t\t\tthis.setItem(ev.item);\r\n\t\t\tthis.events.dispatch(\"selected\", {\r\n\t\t\t\ttype: \"selected\",\r\n\t\t\t\titem: ev.item,\r\n\t\t\t\ttarget: this\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tthis.on(\"active\", (active) => {\r\n\t\t\tif (active) {\r\n\t\t\t\t//dropdown.setPrivate(\"currentId\", $type.numberToString(this.get(\"strokeWidth\")));\r\n\t\t\t\tthis.setTimeout(() => dropdown.show(), 10);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tdropdown.hide();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic setItem(item: string | IDropdownListItem): void {\r\n\t\tif (this.get(\"fixedLabel\") !== true) {\r\n\t\t\tconst label = this.getPrivate(\"label\")!;\r\n\t\t\tif ($type.isString(item)) {\r\n\t\t\t\tlabel.innerHTML = item;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (item.icon) {\r\n\t\t\t\t\tconst icon = this.getPrivate(\"icon\")!;\r\n\t\t\t\t\ticon.innerHTML = \"\";\r\n\t\t\t\t\ticon.appendChild(item.icon.cloneNode(true));\r\n\t\t\t\t\ticon.style.display = \"\";\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\t//icon.style.display = \"none\";\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (item.label) {\r\n\t\t\t\t\tlabel.innerHTML = item.label;\r\n\t\t\t\t\tlabel.style.display = \"\";\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tlabel.innerHTML = \"\";\r\n\t\t\t\t\tlabel.style.display = \"none\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic _beforeChanged() {\r\n\t\tsuper._beforeChanged();\r\n\t\tif (this.isDirty(\"items\")) {\r\n\t\t\tconst dropdown = this.getPrivate(\"dropdown\");\r\n\t\t\tif (dropdown) {\r\n\t\t\t\tconst items = this.get(\"items\");\r\n\t\t\t\tconst dropdownItems: IDropdownListItem[] = [];\r\n\t\t\t\tlet currentItem = this.get(\"currentItem\");\r\n\t\t\t\tif (items) {\r\n\t\t\t\t\t$array.each(items, (item) => {\r\n\t\t\t\t\t\tconst itemObject = $type.isString(item) ? {\r\n\t\t\t\t\t\t\tid: item,\r\n\t\t\t\t\t\t\tlabel: item\r\n\t\t\t\t\t\t} : item;\r\n\t\t\t\t\t\tdropdownItems.push(itemObject);\r\n\r\n\t\t\t\t\t\tif ($type.isString(currentItem) && currentItem == itemObject.id) {\r\n\t\t\t\t\t\t\tcurrentItem = itemObject;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\tdropdown.set(\"items\", dropdownItems)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _dispose(): void {\r\n\t\tsuper._dispose();\r\n\t}\r\n\r\n\r\n}\r\n"]}