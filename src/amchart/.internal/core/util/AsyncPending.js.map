{"version":3,"file":"AsyncPending.js","sourceRoot":"","sources":["../../../../../../src/.internal/core/util/AsyncPending.ts"],"names":[],"mappings":"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","sourcesContent":["/** @ignore *//** */\n\n/**\n * ============================================================================\n * IMPORTS\n * ============================================================================\n * @hidden\n */\nimport * as $array from \"./Array\";\n\n/**\n * [Listener description]\n *\n * @ignore Exclude from docs\n * @todo Description\n */\nexport type Listener = (now: number) => void;\n\n/**\n * @ignore\n */\nlet pendingFrame = false;\n\n/**\n * @ignore\n */\nconst nextQueue: Array<Listener> = [];\n\n/**\n * @ignore\n */\nconst readQueue: Array<Listener> = [];\n\n/**\n * @ignore\n */\nconst writeQueue: Array<Listener> = [];\n\n/**\n * @ignore\n */\nconst idleQueue: Array<Listener> = [];\n\n/**\n * @ignore\n */\nconst fps = 1000 / 60;\n\n/**\n * [raf description]\n *\n * @ignore Exclude from docs\n * @todo Description\n */\nexport const raf =\n\t(typeof requestAnimationFrame === \"function\"\n\t\t? function(fn: () => void): void {\n\t\t\trequestAnimationFrame(fn);\n\t\t}\n\t\t: function(fn: () => void): void {\n\t\t\tsetTimeout(fn, fps);\n\t\t});\n\n/**\n * [frameLoop description]\n *\n * @ignore Exclude from docs\n * @todo Description\n */\nfunction frameLoop(): void {\n\tconst now = Date.now();\n\n\n\tconst length = nextQueue.length;\n\n\tfor (let i = 0; i < length; ++i) {\n\t\tnextQueue[i](now);\n\t}\n\n\t$array.shiftLeft(nextQueue, length);\n\n\n\tfor (let i = 0; i < readQueue.length; ++i) {\n\t\treadQueue[i](now);\n\t}\n\n\treadQueue.length = 0;\n\n\n\tfor (let i = 0; i < writeQueue.length; ++i) {\n\t\twriteQueue[i](now);\n\t}\n\n\twriteQueue.length = 0;\n\n\n\tif (nextQueue.length === 0 && readQueue.length === 0) {\n\t\tpendingFrame = false;\n\n\t} else {\n\t\traf(frameLoop);\n\t}\n}\n\n/**\n * [pendFrame description]\n *\n * @ignore Exclude from docs\n * @todo Description\n */\nfunction pendFrame(): void {\n\tif (!pendingFrame) {\n\t\tpendingFrame = true;\n\n\t\traf(frameLoop);\n\t}\n}\n\n\n/**\n * [nextFrame description]\n *\n * @ignore Exclude from docs\n * @todo Description\n * @param fn [description]\n */\nexport function nextFrame(fn: Listener): void {\n\tnextQueue.push(fn);\n\tpendFrame();\n}\n\n/**\n * [readFrame description]\n *\n * @ignore Exclude from docs\n * @todo Description\n * @param fn [description]\n */\nexport function readFrame(fn: Listener): void {\n\treadQueue.push(fn);\n\tpendFrame();\n}\n\n/**\n * [writeFrame description]\n *\n * @ignore Exclude from docs\n * @todo Description\n * @param fn [description]\n */\nexport function writeFrame(fn: Listener): void {\n\twriteQueue.push(fn);\n\tpendFrame();\n}\n\n/**\n * [whenIdle description]\n *\n * @ignore Exclude from docs\n * @todo Description\n * @param fn [description]\n */\nexport function whenIdle(fn: Listener): void {\n\tidleQueue.push(fn);\n}\n\n/**\n * [triggerIdle description]\n *\n * @ignore Exclude from docs\n * @todo Description\n * @todo Maybe don't trigger a callback which was added while in the middle of triggering?\n */\nexport function triggerIdle(): void {\n\tconst now = Date.now();\n\n\tconst length = idleQueue.length;\n\n\tfor (let i = 0; i < length; ++i) {\n\t\t(<any>idleQueue.shift())(now);\n\t}\n}\n"]}